create database if not exists order_directory;
use order_directory;

create table if not exists SUPPLIER(SUPP_ID INT PRIMARY KEY,SUPP_NAME VARCHAR(50), SUPP_CITY VARCHAR(50),SUB_PHONE VARCHAR(10) );
create table if not exists CUSTOMER(CUS_ID INT NOT NULL,CUS_NAME VARCHAR(20) NULL DEFAULT NULL,CUS_PHONE VARCHAR(10),CUS_CITY VARCHAR(30),CUS_GENDER CHAR,PRIMARY KEY(CUS_ID) );
create table if not exists CATEGORY(CAT_ID INT NOT NULL,CAT_NAME VARCHAR(20) NULL DEFAULT NULL,PRIMARY KEY(CAT_ID));
create table if not exists PRODUCT(PRO_ID INT NOT NULL,PRO_NAME VARCHAR(20) NULL DEFAULT NULL, PRO_DESC VARCHAR(60) NULL DEFAULT NULL,CAT_ID INT NOT NULL, PRIMARY KEY(PRO_ID),FOREIGN KEY (CAT_ID) REFERENCES CATEGORY(CAT_ID));
create table if not exists PRODUCT_DETAILS(PROD_ID INT NOT NULL,PRO_ID INT NOT NULL,SUPP_ID INT NOT NULL,PROD_PRICE INT NOT NULL,PRIMARY KEY(PROD_ID),FOREIGN KEY (PRO_ID) REFERENCES PRODUCT(PRO_ID),FOREIGN KEY (SUPP_ID) REFERENCES SUPPLIER(SUPP_ID));
create table if not exists ORDERS(ORD_ID INT NOT NULL,ORD_AMOUNT INT NOT NULL,ORD_DATE DATE,CUS_ID INT NOT NULL,PROD_ID INT NOT NULL,PRIMARY KEY(ORD_ID),FOREIGN KEY (CUS_ID) REFERENCES CUSTOMER(CUS_ID), FOREIGN KEY (PROD_ID) REFERENCES PRODUCT_DETAILS(PROD_ID));
create table if not exists RATING(RAT_ID INT NOT NULL,CUS_ID INT NOT NULL,SUPP_ID INT NOT NULL,RAT_RATSTARS INT NOT NULL,PRIMARY KEY(RAT_ID),FOREIGN KEY (SUPP_ID) REFERENCES SUPPLIER(SUPP_ID), FOREIGN KEY (CUS_ID) REFERENCES CUSTOMER(CUS_ID));

INSERT INTO SUPPLIER VALUES(1,"RAJESH RETAILS","DELHI",'1234567890');
INSERT INTO SUPPLIER VALUES(2,"APPARIO Ltd.", "MUMBAI", '2589631470');
INSERT INTO SUPPLIER VALUES(3,"KNOME PRODUCTS", "BANGLORE", '9785462315');
INSERT INTO SUPPLIER VALUES(4, "BANSAL RETAILS", "KOCHI", '8975463285');
INSERT INTO SUPPLIER VALUES(5, "MITTAL Ltd.", "LUCKNOW", '7898456532');

INSERT INTO CUSTOMER VALUES(1, "AAKASH", "9999999999", "DELHI","M");
INSERT INTO CUSTOMER VALUES(2, "AMAN", "9785463215", "NOIDA","M");
INSERT INTO CUSTOMER VALUES(3, "NEHA", "9999999999", "MUMBAI","F");
INSERT INTO CUSTOMER VALUES(4, "MEGHA", "9994562399", "KOLKATA","F");
INSERT INTO CUSTOMER VALUES(5, "PULKIT", "7895999999", "LUCKNOW","M");

INSERT INTO CATEGORY VALUES(1,"BOOKS");
INSERT INTO CATEGORY VALUES(2,"GAMES");
INSERT INTO CATEGORY VALUES(3,"GROCERIES");
INSERT INTO CATEGORY VALUES(4,"ELECTRONICS");
INSERT INTO CATEGORY VALUES(5,"CLOTHES");

INSERT INTO PRODUCT VALUES(1,"GTA V","DFJDJFDJFDJFD",2);
INSERT INTO PRODUCT VALUES(2,"TSHIRT","DFDFJDFJDKFD",5);
INSERT INTO PRODUCT VALUES(3,"ROG LAPTOP","DFNTTNTNTERND",4);
INSERT INTO PRODUCT VALUES(4,"OATS","REURENTBTOTH",3);
INSERT INTO PRODUCT VALUES(5,"HARRY POTTER","NBEMCTHTJTH",1);

INSERT INTO PRODUCT_DETAILS VALUES(1,1,2,1500);
INSERT INTO PRODUCT_DETAILS VALUES(2,3,5,30000);
INSERT INTO PRODUCT_DETAILS VALUES(3,5,1,3000);
INSERT INTO PRODUCT_DETAILS VALUES(4,2,3,2500);
INSERT INTO PRODUCT_DETAILS VALUES(5,4,1,1000);

INSERT INTO ORDERS VALUES(50,2000,"2021-10-06",2,1);
INSERT INTO ORDERS VALUES(20,1500,"2021-10-12",3,5);
INSERT INTO ORDERS VALUES(25,305000,"2021-09-16",5,2);
INSERT INTO ORDERS VALUES(26,2000,"2021-10-05",1,1);
INSERT INTO ORDERS VALUES(30,3500,"2021-08-16",4,3);

INSERT INTO RATING VALUES(1,2,2,4);
INSERT INTO RATING VALUES(2,3,4,3);
INSERT INTO RATING VALUES(3,5,1,5);
INSERT INTO RATING VALUES(4,1,3,2);
INSERT INTO RATING VALUES(5,4,5,4);

SELECT CUSTOMER.CUS_GENDER,COUNT(CUSTOMER.CUS_GENDER) AS COUNT FROM CUSTOMER INNER JOIN ORDERS ON CUSTOMER.CUS_ID=ORDERS.CUS_ID WHERE ORDERS.ORD_AMOUNT>=3000 GROUP BY CUSTOMER.CUS_GENDER;
SELECT ORDERS.*, PRODUCT.PRO_NAME FROM ORDERS,PRODUCT_DETAILS,PRODUCT WHERE ORDERS.CUS_ID=2 AND ORDERS.PROD_ID=PRODUCT_DETAILS.PROD_ID AND PRODUCT_DETAILS.PROD_ID=PRODUCT.PRO_ID;
SELECT SUPPLIER.* FROM SUPPLIER,PRODUCT_DETAILS WHERE SUPPLIER.SUPP_ID IN (SELECT PRODUCT_DETAILS.SUPP_ID FROM PRODUCT_DETAILS GROUP BY PRODUCT_DETAILS.SUPP_ID HAVING COUNT(PRODUCT_DETAILS.SUPP_ID)>1) GROUP BY SUPPLIER.SUPP_ID;
SELECT CATEGORY.* FROM ORDERS INNER JOIN PRODUCT_DETAILS ON ORDERS.PROD_ID=PRODUCT_DETAILS.PROD_ID INNER JOIN PRODUCT ON PRODUCT.PRO_ID=PRODUCT_DETAILS.PRO_ID INNER JOIN CATEGORY ON CATEGORY.CAT_ID=PRODUCT.CAT_ID HAVING MIN(ORDERS.ORD_AMOUNT);
SELECT PRODUCT.PRO_ID,PRODUCT.PRO_NAME FROM ORDERS INNER JOIN PRODUCT_DETAILS ON PRODUCT_DETAILS.PROD_ID=ORDERS.PROD_ID INNER JOIN PRODUCT ON PRODUCT.PRO_ID=PRODUCT_DETAILS.PRO_ID WHERE ORDERS.ORD_DATE>"2021-10-05";
SELECT SUPPLIER.SUPP_ID, SUPPLIER.SUPP_NAME, CUSTOMER.CUS_NAME, RATING.RAT_RATSTARS FROM RATING INNER JOIN SUPPLIER ON RATING.SUPP_ID = SUPPLIER.SUPP_ID INNER JOIN CUSTOMER ON RATING.CUS_ID = CUSTOMER.CUS_ID ORDER BY RATING.RAT_RATSTARS DESC LIMIT 3;
select CUSTOMER.CUS_NAME ,CUSTOMER.CUS_GENDER FROM CUSTOMER WHERE CUSTOMER.CUS_NAME LIKE "A%" OR CUSTOMER.CUS_NAME LIKE "%A";
select *FROM ORDERS;
select SUM(ORDERS.ORD_AMOUNT) AS AMOUNT FROM ORDERS INNER JOIN CUSTOMER ON ORDERS.CUS_ID=CUSTOMER.CUS_ID WHERE CUSTOMER.CUS_GENDER="M";
SELECT * FROM CUSTOMER LEFT OUTER JOIN ORDERS ON CUSTOMER.CUS_ID=ORDERS.CUS_ID;
call proc()